<style>
    .table-reduced-head {
        font-size: 70% !important;
    }

    .table-centralized {
        text-align: center;
    }
</style>


<h2> CAPITAL COST - CAPEX </h2>

<div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">

    <div class="btn-group">
        <button id="addEquipment" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown"
            aria-expanded="false">
            New Equipment
        </button>
        <div class="dropdown-menu" aria-labelledby="addEquipment">
            {% for equipment in list_equipments %}
            <a class="dropdown-item"
                href="{% url 'turton:equipment' project.project_number equipment.id %}">{{equipment}}</a>
            {% endfor %}
        </div>
    </div>
    <div class="btn-group">
        <button id="project" type="button" class="btn btn-secondary dropdown-toggle" data-toggle="dropdown"
            aria-expanded="false">
            Projects
        </button>
        <div class="dropdown-menu" aria-labelledby="project">
            {% for project in list_projects %}
            <a class="dropdown-item" href="{% url 'turton:project' project %}">{{project}}</a>
            {% endfor %}
        </div>
    </div>

    <div class="btn-group">
        <a class="btn btn-secondary" href="{% url 'turton:createProject'  %}" role="button">New Project</a>
        <!--button type="button" href="#" class="btn btn-secondary">Editar Projeto</button-->
    </div>
</div>


<!-- TODO: Pensar em uma maneira mais eficiente de chamar os includes necessÃ¡rios -->

<div class="container-fluid mt-2">
    <table id="tableblender" class="table table-responsive table-sm table-centralized">
        <thead class="thead-dark">
            <tr class="d-flex table-reduced-head" id="{{tbl}}">
                <th class="col-2" scope="col"> Options </th>
                <th class="col-1" scope="col"> Equip. Code </th>
                <th class="col-2" scope="col"> Equipment </th>
                <th class="col-2" scope="col"> Type </th>
                <th class="col-2" scope="col"> Techinical Feature (unity) </th>
                <th class="col-1" scope="col"># Spares</th>
                <th class="col-2" scope="col">Pressure (unity)</th>
                <th class="col-1" scope="col"> M.O.C.</th>
                <th class="col-1" scope="col"> Sapce 1</th>
                <th class="col-1" scope="col"> Space 2  </th>
                <th class="col-2" scope="col">Purchased Equipment Cost</th>
                <th class="col-2" scope="col">Bare Module Cost</th>
                <th class="col-2" scope="col">Base Equipment Cost </th>
                <th class="col-2" scope="col">Base Bare Module Cost</th>
            </tr>
        </thead>
        <tbody id="blenderBody">
        {% for tbl in tables_list %}
        {{tbl}}
            {% if tbl == "Blender" %}
            {% include 'project/tables/blender.html'%}
            {% endif%}
            {% if tbl == "Centrifuge" %}
            {% include 'project/tables/centrifuge.html'%}
            {% endif%}
            {% if tbl == "Evaporator" %}
            {% include 'project/tables/evaporator.html'%}
            {% endif%}
            {% if tbl == "Compressor" %}
            {% include 'project/tables/compressor.html'%}
            {% endif%}
            {% if tbl == "Conveyor" %}
            {% include 'project/tables/conveyor.html'%}
            {% endif%}
            {% if tbl == "Crystallizer" %}
            {% include 'project/tables/crystallizer.html'%} 
            {% endif%}     
            {% if tbl == "Drive" %}
            {% include 'project/tables/driver.html'%}
            {% endif%}  
            {% if tbl == "Dryer" %}
            {% include 'project/tables/dryer.html'%}
            {% endif%}  
            {% if tbl == "Dust Collector" %}
            {% include 'project/tables/dust_collector.html'%}
            {% endif%}  
            {% if tbl == "Vaporizer" %}
            {% include 'project/tables/vaporizer.html'%}
            {% endif%} 
            {% if tbl == "Fan" %}
            {% include 'project/tables/fan.html'%}
            {% endif%} 
            {% if tbl == "Filter" %}
            {% include 'project/tables/filter.html'%}
            {% endif%} 
            {% if tbl == "Pump" %}
            {% include 'project/tables/pump.html'%}
            {% endif%} 
            {% if tbl == "Mixer" %}
            {% include 'project/tables/mixer.html'%}
            {% endif%} 
            {% if tbl == "Reactor" %}
            {% include 'project/tables/reactor.html'%}
            {% endif%} 
            {% if tbl == "Screen" %}
            {% include 'project/tables/screen.html'%}
            {% endif%} 
            {% if tbl == "Tank" %}
            {% include 'project/tables/tank.html'%}
            {% endif%} 
            {% if tbl == "Turbine" %}
            {% include 'project/tables/turbine.html'%}
            {% endif%} 
            {% endfor %}
        </tbody>

    </table>
</div>


{% include 'project/tables/total-capex-report.html' %}

<script>
    function removeEquipment(equipment_id) {

        let url = "{% url 'turton:removeEquipment' project.project_number 999 %}".replace(999, equipment_id);

        $.ajax({
            method: "GET",
            url: url,
            success: function (response) {
                document.location.reload(true);
            },
            error: function (error_data) {
                alert(
                    "Ops, houve algum erro. Por favor, entre em contato com o seu administrador ou servidor"
                )
                console.log(error_data)
            },
        });
    }


    function editEquipment(equipment_id) {
        let url = "{% url 'turton:editEquipment' project.project_number 999 %}".replace(999, equipment_id);
        window.location = url;
    }

    function configEquipment(equipment_id) {
        alert("Desabilitado Temporariamente")
        // let url = "{% url 'turton:editEquipment' project.project_number 999 %}".replace(999, equipment_id);
        // window.location = url;
    }

    function deletarProjeto() {
        let url = "{% url 'turton:deleteProject' project.project_number %}"
        console.log(url)

        $.ajax({
            method: "GET",
            url: "{% url 'turton:deleteProject' project.project_number %}",
            success: function (response) {
                console.log(response)
                window.location = "{% url 'turton:index' %}";

            },
            error: function (error_data) {
                alert(
                    "Ops, houve algum erro. Por favor, entre em contato com o seu administrador ou servidor"
                    )
                console.log(error_data)
            },
        });

    }
</script>


<button type="button" class="btn btn-danger mb-3" onclick="deletarProjeto()"> Delete Project </button>



{% block scripts %}

{% endblock %}